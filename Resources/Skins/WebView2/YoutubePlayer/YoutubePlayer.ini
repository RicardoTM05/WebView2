[Rainmeter]
Update=-1
; ============================
; Context menu
; ============================
ContextTitle=Open DevTools
ContextAction=[!CommandMeasure WebView2 "Open DevTools"]

ContextTitle2=Open Task Manager
ContextAction2=[!CommandMeasure WebView2 "Open TaskManager"]

ContextTitle3=Reload
ContextAction3=[!CommandMeasure WebView2 "Navigate Reload"]

; Persist scale value when the skin is closed
OnCloseAction=[!WriteKeyValue Variables Scale [#Scale]]

[Metadata]
Name=Weather
Author=RicardoTM
Information=Simple YouTube Player
Version=0.0.8
License=Creative Commons Attribution-Non-Commercial-Share Alike 3.0

; =============================================================================
; About virtual hosts
; =============================================================================
; This skin demonstrates the use of a WebView2 virtual host.
;
; Using a virtual host allows loading resources that are restricted when using
; the local file:// protocol.
;
; By serving the page through http/https instead of file://:
; - YouTube embeds work correctly (avoids Error 153)
; - Autoplay and other browser APIs are available
; - Local storage can be scoped to the skin
;
; In this case, the WebView2 plugin automatically creates and navigates to:
; https://webview2-youtubeplayer/index.html
; =============================================================================

[Variables]
; UI scale multiplier (mouse wheel adjustable)
Scale=1
; Base width and height
W=558
H=361
; Colors
BGColor=0f0f0f
TxtColor=ffffff

; ========================================
; WebView2 Measure
; ========================================
[WebView2]
Measure=Plugin
Plugin=WebView2

; HostSecurity:
; 0 = http  (insecure context)
; 1 = https (secure context)
; HTTPS is required for YouTube autoplay and modern web APIs
HostSecurity=1

; HostOrigin:
; 1 = root config
; 0 = current config only
; Using current config isolates storage to this skin
HostOrigin=0

; Folder containing the HTML and assets
HostPath=#@#YoutubePlayer\

; Entry HTML file
URL=index.html

; Make it scalable
W=(#W#*#Scale#)
H=(#H#*#Scale#)

; Allow CTRL + drag to move skin and open context menu
SkinControl=2

; Allow links to open in external windows
NewWindow=1

; Disable accessibility features (caret browsing, find and print)
AssistiveFeatures=0

; Show loading meter when navigation starts
OnPageLoadStartAction=[!UpdateMeasure #CURRENTSECTION#][!ShowMeter Loading][!UpdateMeter Loading][!Redraw]

; Hide loading meter when navigation finishes
OnPageLoadFinishAction=[!UpdateMeasure #CURRENTSECTION#][!HideMeter Loading][!UpdateMeter Loading][!Redraw]
DynamicVariables=1

; ========================================
; Background
; ========================================
[Background_Shape]
Meter=Shape
Shape=Rectangle 0,0,(#W#*#Scale#),(#H#*#Scale#),16 | StrokeWidth 0 | FillColor #BGColor#

; Mouse wheel scaling (requires holding CTRL)
MouseScrollUpAction=[!SetVariable Scale "(Clamp(#Scale#+0.1,0.6,2.5))"][!Update]
MouseScrollDownAction=[!SetVariable Scale "(Clamp(#Scale#-0.1,0.6,2.5))"][!Update]

; Reset scale with middle click (requires holding CTRL)
MiddleMouseUpAction=[!SetVariable Scale 1][!Update]
DynamicVariables=1

; ========================================
; Loading indicator
; ========================================
; Displayed while the WebView2 page is loading.
; Automatically shown and hidden by OnPageLoadStartAction and OnPageLoadFinishAction.
[Loading]
Hidden=1
Meter=String
Text=Loading...
FontSize=12
AntiAlias=1
FontColor=#TxtColor#
StringAlign=CenterCenter
X=((#W#/2)*#Scale#)
Y=((#H#/2)*#Scale#)
DynamicVariables=1
