[Rainmeter]
Update=1000
AccurateText=1
DynamicWindowSize=1

[Metadata]
Name=BangCommand
Author=nstechbytes
Information=Demonstrates controlling WebView2 via !CommandMeasure bangs.
Version=0.0.7
License=Creative Commons Attribution-Non-Commercial-Share Alike 3.0

[Variables]
WebURL=https://nstechbytes.pages.dev/
WebW=600
WebH=500
WebX=300
WebY=45
ZoomFactor=1.0
Hidden=0
ClickThrough=0
AllowDualControl=1

; ========================================
; Measure
; ========================================
[MeasureWebView]
Measure=Plugin
Plugin=WebView2
URL=#WebURL#
W=#WebW#
H=#WebH#
X=#WebX#
Y=#WebY#
ZoomFactor=#ZoomFactor#
Hidden=#Hidden#
ClickThrough=#ClickThrough#
AllowDualControl=#AllowDualControl#
OnWebViewLoadAction=[!log "WebView loaded succesfully!"]
OnWebViewFailAction=[!log "WebView failed :("]
OnPageFirstLoadAction=[!log "First time on this page!"]
OnPageLoadStartAction=[!log "Navigation has started!"]
OnPageLoadingAction=[!log "Page is loading!"]
OnPageLoadFinishAction=[!log "Navigation has finished!"]
OnPageReloadAction=[!log "Page has been reloaded!"]
DynamicVariables=1

; ========================================
; Background
; ========================================
[MeterBackground]
Meter=Shape
Shape=Rectangle 0,0,920,570,12 | FillColor 0,0,0,200 | StrokeWidth 0

[Title]
Meter=String
Text=Bang Command Demo
FontSize=16
FontColor=255,255,255,255
AntiAlias=1
X=25
Y=10

[StyleButtonText]
FontColor=255,255,255,255
FontSize=12
AntiAlias=1
W=250
H=25
StringAlign=CenterCenter
SolidColor=0,200,255,150

; ========================================
; Navigate to URL (Dynamic Variables)
; ========================================
[TxtNavigateGoogle]
Meter=String
MeterStyle=StyleButtonText
Text=Navigate to Google (via Variable)
X=150
Y=58
LeftMouseUpAction=[!SetVariable WebURL "https://www.google.com"][!UpdateMeasure MeasureWebView]

[TxtNavigateGitHub]
Meter=String
MeterStyle=StyleButtonText
Text=Navigate to GitHub (via Variable)
X=150
Y=88
LeftMouseUpAction=[!SetVariable WebURL "https://github.com"][!UpdateMeasure MeasureWebView]

[TxtNavigateForum]
Meter=String
MeterStyle=StyleButtonText
Text=Navigate to Forum (via Bang)
X=150
Y=118
LeftMouseUpAction=[!CommandMeasure MeasureWebView "Navigate https://forum.rainmeter.net/"]

[TxtReload]
Meter=String
MeterStyle=StyleButtonText
Text=Reload
X=150
Y=148
LeftMouseUpAction=[!CommandMeasure MeasureWebView "Reload"]

[TxtGoBack]
Meter=String
MeterStyle=StyleButtonText
Text=Go Back
W=122
H=24
X=86
Y=178
LeftMouseUpAction=[!CommandMeasure MeasureWebView "GoBack"]

[TxtGoForward]
Meter=String
MeterStyle=StyleButtonText
Text=Go Forward
W=125
H=24
X=212
Y=178
LeftMouseUpAction=[!CommandMeasure MeasureWebView "GoForward"]

[TxtShow]
Meter=String
MeterStyle=StyleButtonText
Text=Show
W=122
H=24
X=86
Y=208
LeftMouseUpAction=[!SetVariable Hidden 0][!UpdateMeasure MeasureWebView]

[TxtHide]
Meter=String
MeterStyle=StyleButtonText
Text=Hide
W=125
H=24
X=212
Y=208
LeftMouseUpAction=[!SetVariable Hidden 1][!UpdateMeasure MeasureWebView]

[TxtExecuteScript]
Meter=String
MeterStyle=StyleButtonText
Text=Execute Script
X=150
Y=238
LeftMouseUpAction=[!CommandMeasure MeasureWebView "ExecuteScript console.log('Script has been executed.')"]

[TxtOpenDevTools]
Meter=String
MeterStyle=StyleButtonText
Text=Open DevTools
X=150
Y=268
LeftMouseUpAction=[!CommandMeasure MeasureWebView "OpenDevTools"]

[TxtSetWidth]
Meter=String
MeterStyle=StyleButtonText
Text=Set Width: 500 (via Variable)
X=150
Y=298
LeftMouseUpAction=[!SetVariable WebW (#WebW#=600?500:600)][!UpdateMeasure MeasureWebView][!UpdateMeter #CURRENTSECTION#][!Redraw]
DynamicVariables=1

[TxtSetHeight]
Meter=String
MeterStyle=StyleButtonText
Text=Set Height: 400 (via Variable)
X=150
Y=328
LeftMouseUpAction=[!SetVariable WebH (#WebH#=410?470:410)][!UpdateMeasure MeasureWebView][!UpdateMeter #CURRENTSECTION#][!Redraw]
DynamicVariables=1

[TxtSetX]
Meter=String
MeterStyle=StyleButtonText
Text=Set X: 320 (via Variable)
X=150
Y=358
LeftMouseUpAction=[!SetVariable WebX (#WebX#=300?320:300)][!UpdateMeasure MeasureWebView][!UpdateMeter #CURRENTSECTION#][!Redraw]
DynamicVariables=1

[TxtSetY]
Meter=String
MeterStyle=StyleButtonText
Text=Set Y: 50 (via Variable)
X=150
Y=388
LeftMouseUpAction=[!SetVariable WebY (#WebY#=45?50:45)][!UpdateMeasure MeasureWebView][!UpdateMeter #CURRENTSECTION#][!Redraw]
DynamicVariables=1

[TxtSetZoom]
Meter=String
MeterStyle=StyleButtonText
Text=Set ZoomFactor: 2.0 (via Variable)
X=150
Y=418
LeftMouseUpAction=[!SetVariable ZoomFactor (#ZoomFactor#=1?2:1)][!UpdateMeasure MeasureWebView][!UpdateMeter #CURRENTSECTION#][!Redraw]
DynamicVariables=1

[TxtSetEnableClickThrough]
Meter=String
MeterStyle=StyleButtonText
Text=Set ClickThrough: 1 (via Variable)
X=150
Y=448
LeftMouseUpAction=[!SetVariable ClickThrough 1][!UpdateMeasure MeasureWebView]

[TxtSetDisableClickThrough]
Meter=String
MeterStyle=StyleButtonText
Text=Set ClickThrough: 0 (via Variable)
X=150
Y=478
LeftMouseUpAction=[!SetVariable ClickThrough 0][!UpdateMeasure MeasureWebView]

[TxtSetEnableAllowDualControl]
Meter=String
MeterStyle=StyleButtonText
Text=Set AllowDualControl: 1 (Variable)
X=150
Y=508
LeftMouseUpAction=[!SetVariable AllowDualControl 1][!UpdateMeasure MeasureWebView]

[TxtSetDisableAllowDualControl]
Meter=String
MeterStyle=StyleButtonText
Text=Set AllowDualControl: 0 (Variable)
X=150
Y=538
LeftMouseUpAction=[!SetVariable AllowDualControl 0][!UpdateMeasure MeasureWebView]
